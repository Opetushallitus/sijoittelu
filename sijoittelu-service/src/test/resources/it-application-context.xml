<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:jaxrs="http://cxf.apache.org/jaxrs"
       xmlns:http="http://cxf.apache.org/transports/http/configuration"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.0.xsd
         http://cxf.apache.org/jaxrs http://cxf.apache.org/schemas/jaxrs.xsd
         http://cxf.apache.org/transports/http/configuration http://cxf.apache.org/schemas/configuration/http-conf.xsd
         http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd">

    <context:annotation-config/>
    <import resource="classpath:META-INF/cxf/cxf.xml" />
    <import resource="classpath:META-INF/cxf/cxf-servlet.xml" />

    <bean id="jsonProvider" class="com.fasterxml.jackson.jaxrs.json.JacksonJsonProvider" />


    <beans
      xmlns:mockito="http://www.mockito.org/spring/mockito"
      xsi:schemaLocation="http://www.mockito.org/spring/mockito http://www.mockito.org/spring/mockito.xsd"
      profile="it">

      <context:property-placeholder
        location="classpath:sijoittelu-service.properties, classpath:it-profile.properties"
        ignore-resource-not-found="true"/>

      <mockito:mock id="valintaperusteetResource" class="fi.vm.sade.service.valintaperusteet.resource.ValintaperusteetResource" />
      <mockito:mock id="valintalaskentakoostepalvelu" class="fi.vm.sade.service.valintaperusteet.resource.ValintalaskentakoostepalveluResource" />
      <mockito:mock id="ohjausparametriResource" class="fi.vm.sade.sijoittelu.laskenta.external.resource.OhjausparametriResource" />
      <mockito:mock id="hakuV1Resource" class="fi.vm.sade.sijoittelu.laskenta.external.resource.HakuV1Resource" />
      <mockito:mock id="hakukohdeV1Resource" class="fi.vm.sade.sijoittelu.laskenta.external.resource.HakukohdeV1Resource" />
      <mockito:mock id="valintaTulosServiceResource" class="fi.vm.sade.sijoittelu.laskenta.external.resource.VirkailijaValintaTulosServiceResource" />

      <context:component-scan base-package="fi.vm.sade.sijoittelu.tulos"/>
      <context:component-scan base-package="fi.vm.sade.sijoittelu.laskenta"/>
      <context:component-scan base-package="fi.vm.sade.sijoittelu.batch"/>
      <context:component-scan base-package="fi.vm.sade.security.mock"/>

      <bean id="mongoConfiguration" class="fi.vm.sade.mongo.MongoConfigurationSmoke"/>

      <context:component-scan base-package="fi.vm.sade.valintalaskenta.tulos.dao"/>
      <context:component-scan base-package="fi.vm.sade.valintalaskenta.tulos.service.impl"/>
      <context:component-scan base-package="fi.vm.sade.valintalaskenta.tulos.resource.impl"/>
      <context:component-scan base-package="fi.vm.sade.valintalaskenta.tulos.service.impl.converters"/>

      <bean id="modelMapper" class="fi.vm.sade.valintalaskenta.tulos.mapping.ValintalaskentaModelMapper"/>

      <bean id="sijoitteluModelMapper" class="fi.vm.sade.sijoittelu.laskenta.mapping.SijoitteluModelMapper"/>

        <bean id="cors-filter" class="fi.vm.sade.sijoittelu.laskenta.resource.filter.CorsResponseFilter"/>
    <jaxrs:server id="sijoitteluResurssi">
        <jaxrs:serviceBeans>
            <ref bean="sijoitteluResource"/>
            <ref bean="tilaResource"/>
            <ref bean="erillisSijoitteluResource"/>
            <ref bean="valiSijoitteluResource"/>
            <ref bean="sijoitteluResourceImpl"/>
            <ref bean="sessionResource"/>
        </jaxrs:serviceBeans>
        <jaxrs:providers>
            <ref bean="jsonProvider" />
            <ref bean="cors-filter"/>
        </jaxrs:providers>
    </jaxrs:server>
    </beans>

</beans>
